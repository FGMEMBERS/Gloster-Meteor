<?xml version="1.0" encoding="utf-8"?>
<?xml-stylesheet type="text/xsl" href="http://jsbsim.sf.net/JSBSimScript.xsl"?>
<runscript xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
    xsi:noNamespaceSchemaLocation="http://jsbsim.sf.net/JSBSimScript.xsd"
    name="Cruise flight in Gloster Meteor F.3.">

  <description>
    This is a very simple script that trims the aircraft with running
    engines at altitude and runs out to 60 seconds. Some state data
    is printed out at five second intervals. At 20 seconds ailerons are
    deflected 100% for five seconds.
  </description>

  <use aircraft="gloster-meteor-jsb" initialize="cruise_init"/> 

  <run start="0" end="90" dt="0.008333">

    <property value="20"> simulation/notify-time-trigger </property>

    <event name="Set engines running">
      <condition> simulation/sim-time-sec le 0.1 </condition>
      <set name="propulsion/engine[0]/set-running" value="1"/>
      <set name="propulsion/engine[1]/set-running" value="1"/>
      <set name="fcs/throttle-cmd-norm[0]" value="1"/>
      <set name="fcs/throttle-cmd-norm[1]" value="1"/>
      <set name="gear/gear-cmd-norm" value="0"/>
      <set name="gear/gear-pos-norm" value="0"/>
      <notify/>
    </event>

    <!--
      For "do_simple_trim" (Classic trim):
      0: Longitudinal
      1: Full
      2: Ground
      3: Pullup
      4: Custom
      5: Turn
      6: None
    <event name="Trim">
      <condition> simulation/sim-time-sec gt 0.1 </condition>
      <set name="simulation/do_simple_trim" value="1"/>
      <delay>5.0</delay>
      <notify>
        <property>propulsion/engine[0]/n2</property>
        <property>propulsion/engine[1]/n2</property>
        <property>propulsion/engine[0]/thrust-lbs</property>
        <property>propulsion/engine[1]/thrust-lbs</property>
        <property>velocities/vc-kts</property>
        <property>velocities/vc-fps</property>
        <property>velocities/vt-fps</property>
        <property>attitude/phi-rad</property>
        <property>attitude/theta-rad</property>
        <property>attitude/psi-rad</property>
      </notify>
    </event>
    -->

    <event name="Repeating Notify" persistent="true">
      <description>Output message at 5 second intervals</description>
      <notify>
<!--        <property>propulsion/engine[0]/n2</property>
        <property>propulsion/engine[1]/n2</property>
        <property>propulsion/engine[2]/n2</property>
        <property>propulsion/engine[3]/n2</property>
        <property>propulsion/engine[0]/thrust-lbs</property>
        <property>propulsion/engine[1]/thrust-lbs</property>
        <property>propulsion/engine[2]/thrust-lbs</property>
        <property>propulsion/engine[3]/thrust-lbs</property>
-->        <property>position/h-agl-ft</property>
        <property>velocities/vc-kts</property>
        <property>velocities/vc-fps</property>
        <property>velocities/vt-fps</property>
        <property>attitude/phi-rad</property>
        <property>attitude/theta-rad</property>
        <property>attitude/psi-rad</property>
      </notify>
      <condition> simulation/sim-time-sec >= simulation/notify-time-trigger </condition>
      <set name="simulation/notify-time-trigger" value="25" type="FG_DELTA"/>
    </event>
    <event name="Aileron applied">
      <description>Roll Stability Testing</description>
      <condition>simulation/sim-time-sec ge 20</condition>
      <set name="fcs/aileron-cmd-norm" value="1.0"/>
      <notify/>
    </event>
    <event name="Recovery">
      <description>Roll Stability Testing</description>
      <condition>simulation/sim-time-sec ge 35</condition>
      <set name="fcs/aileron-cmd-norm" value="0.0"/>
      <set name="ap/afcs/theta-trim-rad" value="-.02"/>
      <set name="ap/afcs/psi-trim-rad" value="3.926"/>
      <set name="ap/afcs/phi-trim-rad" value="0.0"/>
      <set name="ap/afcs/pitch-channel-active-norm" value="20"/>
      <set name="ap/afcs/yaw-channel-active-norm" value="50"/>
      <set name="ap/afcs/roll-channel-active-norm" value="50"/>

      <notify/>
    </event>

  </run>

</runscript>
